<div class="answer-page">
  <div class="question-details">
    <div class="question-stats">
      <div class="stats">
        <span class="votes">{{ question?.votes }} votes</span>
        <span class="views">{{ question?.views }} views</span>
      </div>
    </div>

    <div class="question-content">
    <h3>{{ question?.title }}</h3>
    <p class="question-body">{{ question?.description }}</p>
      <p class="question-meta">
        <strong>Posted by:</strong> {{ question?.userName }}
        <span class="date">{{ formatDate(question?.postedOn,"MM/dd/yyyy 'at' h:mma","EN") }}</span>
      </p>
    <div class="tags-box">
      <span class="tag" *ngFor="let tag of question?.tags">{{ tag.name }}</span>
    </div>
    </div>
  </div>

  <div class="answers-section">
    <h3>{{ answers?.length || 0 }} Answers</h3>
    <div class="answer-list">
      <div class="answer" *ngFor="let answer of answers">
        <div class="answer-content">
          <div class="answer-body" [innerHTML]="formatContent(answer.body)"></div>
          <div *ngFor="let snippet of answer.codeSnippets">
            <app-code-snippet
              [code]="snippet.code"
              [language]="snippet.language">
            </app-code-snippet>
          </div>
          <div class="answer-meta">
            <span class="answered-by">
              <strong>Answered by:</strong> {{ answer.answeredBy }}
            </span>
            <span class="date">{{ formatDate(answer.dateAnswered,"MM-DD-YYYY","EN") }}</span>
          </div>
          <div class="votes">
            <span class="vote-count">{{ answer.votes }}</span> votes
          </div>
          <div class="attachments" *ngIf="answer.attachments?.length">
            <h4>Attachments:</h4>
            <ul>
              <li *ngFor="let attachment of answer.attachments">
                {{ attachment }}
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="answer-form">
    <h4>Post Your Answer</h4>
    <form (ngSubmit)="submitAnswer()">
      <div class="form-group">
        <div class="editor-toolbar">
          <button type="button" (click)="openCodeEditor()" class="toolbar-btn">
            <span class="code-icon">&lt;/&gt;</span>
            Code Snippet
          </button>
        </div>
        <textarea
          [(ngModel)]="answerBody"
          name="answer"
          placeholder="Type your answer here... Use the code button above to insert code snippets"
          required
          #answerTextarea
        ></textarea>
      </div>

      <div class="file-upload">
        <label for="file-input" class="file-label">
          <span>Choose a file</span>
          <input
            type="file"
            id="file-input"
            (change)="onFileSelected($event)"
          />
        </label>
        <p *ngIf="selectedFileName" class="file-name">
          Selected file: {{ selectedFileName }}
        </p>
        <div *ngIf="fileUploaded" class="success-message">
          File uploaded successfully!
        </div>
      </div>

      <button type="submit" [disabled]="!answerBody.trim()">
        Submit Answer
      </button>
    </form>
  </div>

  <app-code-editor
    *ngIf="showCodeEditor"
    (close)="showCodeEditor = false"
    (submit)="onCodeSubmit($event)"
  ></app-code-editor>
</div>
